The three functions are called